{% extends 'base.html' %}

{% block title %} Grades {% endblock %}

{% block content %}
<div class="main-container flex-container">
    <!--instructor view-->
    


    <!--Student view-->
    {%if session['userInfo']['accountType'] == 'stu' %}
    <!-- Assignments Section -->
    <div class="flex-left">
        <div class="container">
            <div class="container-header">
                <h2>All Assignments</h2>
            </div>
            <div class="container-content">
                <div class="grades-table">
                    <div class="table-header">
                        <div class="header-cell">Evaluation</div>
                        <div class="header-cell">Grade</div>
                        <div class="header-cell">Action</div>
                    </div>
                    {% for mark in student_marks %}
                        {% if ("assignment" in mark[1].title.lower()) %}
                        <div class="table-row">
                            <div class="table-cell">{{ mark[1].title }}</div>
                            <div class="table-cell">{{ 100 * mark[0].grade // mark[1].maxGrade }}% ({{ mark[0].grade }}/{{ mark[1].maxGrade }})</div>
                            <div class="table-cell">
                                {% if mark[1].releasedAt <= current_time %}
                                <form action="{{ url_for('request_regrade', mark_id=mark.markId) }}" method="GET">
                                    <button type="submit">Request Regrade</button>
                                </form>
                                {% else %}
                                <span class="not-released">Not released yet</span>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <!-- Labs/Tutorials Section -->
    <div class="flex-left">
        <div class="container">
            <div class="container-header">
                <h2>Labs/Tutorials</h2>
            </div>
            <div class="container-content">
                <div class="grades-table">
                    <div class="table-header">
                        <div class="header-cell">Evaluation</div>
                        <div class="header-cell">Grade</div>
                        <div class="header-cell">Action</div>
                    </div>
                    {% for mark in student_marks %}
                        {% if ("lab" in mark[1].title.lower() or "tutorial" in mark[1].title.lower()) %}
                        <div class="table-row">
                            <div class="table-cell">{{ mark[1].title }}</div>
                            <div class="table-cell">{{ 100 * mark[0].grade // mark[1].maxGrade }}% ({{ mark[0].grade }}/{{ mark[1].maxGrade }})</div>
                            <div class="table-cell">
                                {% if mark[1].releasedAt <= current_time %}
                                <form action="{{ url_for('request_regrade', mark_id=mark.markId) }}" method="GET">
                                    <button type="submit">Request Regrade</button>
                                </form>
                                {% else %}
                                <span class="not-released">Not released yet</span>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <!-- Exams Section -->
    <div class="flex-left">
        <div class="container">
            <div class="container-header">
                <h2>Exams</h2>
            </div>
            <div class="container-content">
                <div class="grades-table">
                    <div class="table-header">
                        <div class="header-cell">Evaluation</div>
                        <div class="header-cell">Grade</div>
                        <div class="header-cell">Action</div>
                    </div>
                    {% for mark in student_marks %}
                        {% if ("exam" in mark[1].title.lower() or "midterm" in mark[1].title.lower() or "final" in mark[1].title.lower()) %}
                        <div class="table-row">
                            <div class="table-cell">{{ mark[1].title }}</div>
                            <div class="table-cell">{{ 100 * mark[0].grade // mark[1].maxGrade }}% ({{ mark[0].grade }}/{{ mark[1].maxGrade }})</div>
                            <div class="table-cell">
                                {% if mark[1].releasedAt <= current_time %}
                                <form action="{{ url_for('request_regrade', mark_id=mark.markId) }}" method="GET">
                                    <button type="submit">Request Regrade</button>
                                </form>
                                {% else %}
                                <span class="not-released">Not released yet</span>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
{% endif %}
</div>
{% endblock %}